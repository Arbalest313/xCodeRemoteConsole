<!DOCTYPE html>
<!-- saved from url=(0025)http://172.16.24.71:8080/ -->
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>TestNSlog[39888]</title>
    <style>
    body {
        margin: 0px;
        font-family: Courier, monospace;
        font-size: 0.8em;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    
    tr {
        vertical-align: top;
    }
    
    tr:nth-child(odd) {
        background-color: #eeeeee;
    }
    
    td {
        padding: 2px 10px;
    }
    
    #footer {
        text-align: center;
        margin: 20px 0px;
        color: darkgray;
    }
    
    .error {
        color: red;
        font-weight: bold;
    }
    </style>
    <script type="text/javascript">
    var refreshDelay = 500;
    var footerElement = null;

    function updateTimestamp() {
        var now = new Date();
        footerElement.innerHTML = "Last updated on " + now.toLocaleDateString() + " " + now.toLocaleTimeString();
    }

    function refresh() {
        var timeElement = document.getElementById("maxTime");
        var maxTime = timeElement.getAttribute("data-value");
        timeElement.parentNode.removeChild(timeElement);

        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4) {
                if (xmlhttp.status == 200) {
                    var contentElement = document.getElementById("content");
                    contentElement.innerHTML = contentElement.innerHTML + xmlhttp.responseText;
                    updateTimestamp();
                    setTimeout(refresh, refreshDelay);
                } else {
                    footerElement.innerHTML = "<span class=\"error\">Connection failed! Reload page to try again.</span>";
                }
            }
        }
        xmlhttp.open("GET", "/log?after=" + maxTime, true);
        xmlhttp.send();
    }
    window.onload = function() {
        footerElement = document.getElementById("footer");
        updateTimestamp();
        setTimeout(refresh, refreshDelay);
    }
    var ipAddress = getUrlParameter('ip');
    var wsUri ="ws://" + ipAddress + ":9001"; 
    var output;  
    
    function init() { 
        output = document.getElementById("content"); 
        testWebSocket(); 
    }  
 
    function testWebSocket() { 
        websocket = new WebSocket(wsUri); 
        websocket.onopen = function(evt) { 
            onOpen(evt) 
        }; 
        websocket.onclose = function(evt) { 
            onClose(evt) 
        }; 
        websocket.onmessage = function(evt) { 
            onMessage(evt) 
        }; 
        websocket.onerror = function(evt) { 
            onError(evt) 
        }; 
    }  
 
    function onOpen(evt) { 
        writeToScreen("CONNECTED"); 
        doSend("WebSocket rocks"); 
    }  
 
    function onClose(evt) { 
        writeToScreen("DISCONNECTED"); 
    }  
 
    function onMessage(evt) { 
        // writeToScreen('<tr style="color: dimgray;"><td> '+ evt.data+'</td></tr>'); 
                writeToScreen( evt.data); 

        // websocket.close(); 
    }  
 
    function onError(evt) { 
        writeToScreen('<span style="color: red;">ERROR:</span> '+ evt.data); 
    }  
 
    function doSend(message) { 
        writeToScreen("SENT: " + message);  
        websocket.send(message); 
    }  
 
    function writeToScreen(message) { 
      var tr = document.createElement('tr');   
      var pre = document.createElement('pre');
      var td1 = document.createElement('td');

      var text1 = document.createTextNode(message);
      pre.appendChild(text1)
      td1.appendChild(pre);
      tr.appendChild(td1);
      output.appendChild(tr);
      footerElement.scrollIntoView(false);
    }  
    window.addEventListener("load", init, false);  

    function getUrlParameter(sParam) {
          var sPageURL = decodeURIComponent(window.location.search.substring(1)),
              sURLVariables = sPageURL.split('&'),
              sParameterName,
              i;

          for (i = 0; i < sURLVariables.length; i++) {
              sParameterName = sURLVariables[i].split('=');

              if (sParameterName[0] === sParam) {
                  return sParameterName[1] === undefined ? true : sParameterName[1];
              }
          }
      }
    </script>
</head>

<body>
    <table>
        <tbody id="content"></tbody>
    </table>
    <div id="footer">Last updated on 1/10/2017 5:51:18 PM</div>
</body>

</html>